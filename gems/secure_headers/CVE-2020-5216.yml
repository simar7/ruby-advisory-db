gem: secure_headers
ghsa: w978-rmpf-qmwg
cve: 2020-5216
url: https://github.com/twitter/secure_headers/security/advisories/GHSA-w978-rmpf-qmwg
title: 'CVE-2020-5216 rubygem-secure_headers: limited header injection when using
  dynamic overrides with user input'
date: "2020-01-23"
description: In Secure Headers (RubyGem secure_headers), a directive injection vulnerability
  is present in versions before 3.9.0, 5.2.0, and 6.3.0. If user-supplied input was
  passed into append/override_content_security_policy_directives, a newline could
  be injected leading to limited header injection. Upon seeing a newline in the header,
  rails will silently create a new Content-Security-Policy header with the remaining
  value of the original string. It will continue to create new headers for each newline.
  This has been fixed in 6.3.0, 5.2.0, and 3.9.0. A directive injection vulnerability
  was found in Secure Headers RubyGem before versions 3.9.0, 5.2.0, and 6.3.0. If
  user-supplied input was passed into the vulnerable function, a new line could be
  injected, leading to limited header injection, which could create a new Content
  Security Policy header in the HTTP response.
cvss_v3: 4.4
patched_versions:
- ~> 3.9
- ~> 5.2
- '>= 6.3.0'
