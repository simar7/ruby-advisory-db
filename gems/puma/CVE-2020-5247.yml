gem: puma
ghsa: 84j7-475p-hp8v
cve: 2020-5247
url: https://github.com/puma/puma/security/advisories/GHSA-84j7-475p-hp8v
title: 'CVE-2020-5247 rubygem-puma: attacker is able to use newline characters to
  insert malicious content (HTTP Response Splitting), this could lead to XSS'
date: "2020-02-27"
description: In Puma (RubyGem) before 4.3.2 and before 3.12.3, if an application using
  Puma allows untrusted input in a response header, an attacker can use newline characters
  (i.e. `CR`, `LF` or`/r`, `/n`) to end the header and inject malicious content, such
  as additional headers or an entirely new response body. This vulnerability is known
  as HTTP Response Splitting. While not an attack in itself, response splitting is
  a vector for several other attacks, such as cross-site scripting (XSS). This is
  related to CVE-2019-16254, which fixed this vulnerability for the WEBrick Ruby web
  server. This has been fixed in versions 4.3.2 and 3.12.3 by checking all headers
  for line endings and rejecting headers with those characters. A flaw was discovered
  in rubygem-puma, where it did not properly forbid untrusted input in a response
  header. This flaw allows an attacker with the ability to tamper with HTTP headers
  to insert a new-line and insert malicious content, allowing an HTTP response splitting,
  which exposes the risk of attacks such as cross-site scripting.
cvss_v3: 6.5
patched_versions:
- ~> 3.12.4
- '>= 4.3.3'
related:
  cve:
  - 2019-16254
