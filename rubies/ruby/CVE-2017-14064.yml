engine: ruby
cve: 2017-14064
url: https://www.ruby-lang.org/en/news/2017/09/14/json-heap-exposure-cve-2017-14064/
title: 'CVE-2017-14064 ruby: Arbitrary heap exposure during a JSON.generate call'
date: "2017-09-14"
description: Ruby through 2.2.7, 2.3.x through 2.3.4, and 2.4.x through 2.4.1 can
  expose arbitrary memory during a JSON.generate call. The issues lies in using strdup
  in ext/json/ext/generator/generator.c, which will stop after encountering a '\0'
  byte, returning a pointer to a string of length zero, which is not the length stored
  in space_len. A buffer overflow vulnerability was found in the JSON extension of
  ruby. An attacker with the ability to pass a specially crafted JSON input to the
  extension could use this flaw to expose the interpreter's heap memory.
patched_versions:
- ~> 2.2.8
- ~> 2.3.5
- '>= 2.4.2'
